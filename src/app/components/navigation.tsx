import {
  Disc3,
  Headphones,
  Heart,
  UserRound,
  Library,
  SquareArrowOutUpRight,
  Sun,
  Moon,
  Users,
  BarChart3,
  Newspaper,
} from "lucide-react";
import { useState } from "react";
import { useApp, type Screen } from "./app-context";

/** Desktop top nav — left group */
const DESKTOP_LEFT_NAV: { id: Screen; label: string; icon: typeof Disc3 }[] = [
  { id: "feed", label: "Feed", icon: Newspaper },
  { id: "friends", label: "Following", icon: Users },
  { id: "crate", label: "Collection", icon: Library },
  { id: "wants", label: "Wants", icon: Heart },
];

/** Desktop top nav — right group */
const DESKTOP_RIGHT_NAV: { id: Screen; label: string; icon: typeof Disc3 }[] = [
  { id: "sessions", label: "Sessions", icon: Headphones },
  { id: "purge", label: "Purge", icon: SquareArrowOutUpRight },
  { id: "reports", label: "Insights", icon: BarChart3 },
  { id: "settings", label: "Settings", icon: UserRound },
];

/** Mobile bottom bar */
const MOBILE_NAV_ITEMS: { id: Screen; label: string; icon: typeof Disc3 }[] = [
  { id: "feed", label: "Feed", icon: Newspaper },
  { id: "friends", label: "Following", icon: Users },
  { id: "crate", label: "Collection", icon: Library },
  { id: "wants", label: "Wants", icon: Heart },
  { id: "sessions", label: "Sessions", icon: Headphones },
];

/** SVG wordmark logo — "Holy Grails" with integrated vinyl record icon */
export function WordmarkLogo({ className, onLogoClick, fillColor, isDarkMode = false }: { className?: string; onLogoClick?: () => void; fillColor?: string; isDarkMode?: boolean }) {
  const [spinning, setSpinning] = useState(false);
  const fill = fillColor || "#0C284A";
  // Logomark jagged edge + center hole: always pure black, never changes
  const logomarkFill = "#000000";

  const handleClick = () => {
    if (!spinning) {
      setSpinning(true);
      setTimeout(() => setSpinning(false), 600);
    }
    onLogoClick?.();
  };

  // Center of the vinyl record yellow disc
  const recordCx = 65.62;
  const recordCy = 16.05;

  /* Inline path data for the new logo (viewBox 0 0 138.7876 32.0856) */
  const RECORD_BODY = "M61.0117,0c.0441.0719.1394.2175.2998.3428.184.1439.6254.3731,1.1365.1321.0344-.0163.0664-.035.0971-.0534.1334.0382.2876.0549.4604.0272.0233.0808.0467.1564.07.2266.0411.1241.0899.2545.1485.3746.0441.0904.1511.3015.3549.472l.0037.0019.0027.0028c.1386.1159.3894.2667.7313.2604.3462-.0066.5957-.1708.7358-.3025.0368-.0346.0692-.0714.099-.1077.0739.0119.1532.0175.2382.0131.1294-.0067.2441-.0341.3446-.0731.0776.0769.1768.1564.3025.2201.2789.1412.6049.1654.9067.0562.2574-.0932.4248-.2563.5165-.3625.0361.0195.0743.0389.1158.0553.2707.1069.5517.0921.7853.0009.366-.1429.5348-.4383.565-.4889l.0075-.0131c.0122-.0205.0237-.042.0355-.0637.0764.0212.1589.0365.2474.0393.0796.0822.1798.1611.3053.2229.1664.1746.4101.3166.7033.339.0064.0481.0159.1007.0298.1555.0198.0777.1042.4039.423.6378l.0029.0019.0028.0028c.2716.1989.5465.2289.7704.1976.0193.095.0521.2016.1055.3081.0766.1525.2318.3743.5183.5095.2973.1401.5842.1163.7798.059l.0027-.0009.0047-.0009c.3024-.0888.5006-.2888.5604-.3484.0773-.0774.15-.1641.2165-.2491.1778.0625.356.0735.5072.0525.0767-.0107.145-.0317.2054-.0525.0539.0953.1272.1928.2288.2819.1443.1267.2959.1976.4389.2341.0184.1537.0762.3668.2438.5676.1358.1627.293.2598.4445.3156.0037.0122.0068.0252.0111.0375.1283.3646.4352.621.7966.695-.0095.0226-.0197.0451-.028.0684-.0268.075-.1145.3306-.0439.6444.0284.126.0836.2624.1747.3906.0195.0696.0472.1421.0858.2154.1975.3745.5363.5192.7602.5629.1395.0272.2639.0229.3548.0131.1282.1546.2918.2649.4585.3278.1675.063.3229.074.4306.0721-.0177.0227-.0364.0461-.0533.0712-.0425.0635-.1589.2461-.1867.5086-.0157.1482-.0043.3391.0813.5385.0872.2034.2252.3538.3679.4543.25.1759.501.1936.5836.1976.0237.0012.0471.0011.0691.0009.0303.0595.0661.118.1092.1733.0865.1109.1842.1891.2737.2463.009.017.0184.0336.028.0496-.1145.0513-.216.0992-.3044.1433-.1302.065-.34.1738-.5024.3194-.0475.0425-.1274.1193-.2009.2304-.0675.1023-.1935.3306-.181.6452.0145.3658.2048.6383.4034.7972.1687.1349.3376.188.4183.2088l.0047.0009.0055.002c.2258.0584.4764.1086.7471.1526l.0075.0008.0084.002c.2485.0404.5095.0827.783.1264l.0067.001h.0029c-.0985.0302-.1922.0592-.2792.088-.271.0902-.5506.1955-.7628.3213l-.013.0075c-.1359.0804-.419.2604-.593.5787-.1039.1903-.1853.4618-.128.7746.0104.0558.0255.1086.0421.1583-.0128.0955-.0164.1975-.0047.3043.0367.3336.1975.5854.354.7521l.0056.0057c.025.0267.0508.0514.0765.074-.081.112-.1604.2637-.1942.458-.0674.3869.082.7016.2353.8888.1342.1637.2861.2543.367.2978.0917.0492.1805.0832.2502.1067l.0094.0029.0084.0037c.0035.0011.0078.0018.0112.0029-.0415.0965-.0727.2088-.0831.3371-.0093.1136.0004.2177.0206.3118-.0214.0105-.043.0213-.0644.0329-.1097.0592-.2914.1733-.439.3755-.1733.2375-.2761.5706-.1941.9319.0701.3098.2483.5115.3558.6135l.0036.0038.0038.0028c.1746.1658.379.2575.4753.2988.1274.0546.2718.1048.421.1507.3002.0927.6952.1926,1.1705.2997l.0286.0057.0277.0065c.0249.0056.0497.0113.0736.0169-.0019.0068-.0019.0138-.0028.0206-.2391.0162-.5756.0195-1.026-.0019l-.0182-.0009-.0201-.0009-.2544-.0075c-.0822-.0007-.1616.0012-.2362.0055-.1055.0062-.3576.0224-.598.1378-.1225.0588-.4171.2266-.5621.6031-.0627.163-.0797.3174-.071.4562-.0879.0273-.221.08-.3549.1844-.191.1491-.3888.4135-.4127.7801-.0046.0711-.001.1383.0065.2005-.0295.1063-.0459.2202-.0401.339.0107.2198.0859.3894.1466.4945-.077.2402-.0546.4618-.0103.6211-.1929.1506-.3663.3876-.4062.7165-.0024.0197-.0034.0398-.0047.059-.0052.002-.0107.0033-.0159.0056-.2693.1114-.55.3585-.6462.752-.0756.3099.0016.564.0458.679-.18.0423-.4319.1498-.6229.4075-.071.0958-.1188.1946-.1513.2884-.0957.0481-.1946.1141-.2857.2071-.2129.217-.2863.4715-.3045.6555-.0046.0482-.0058.0952-.0045.1396-.0066-.0038-.0125-.0086-.0188-.0121-.0603-.0345-.2456-.1389-.4941-.163-.1394-.0135-.3717-.0087-.6162.1217-.2274.1215-.3783.3043-.466.488-.1563.0322-.326.1027-.4875.2397l-.0019.0019-.0028.0019c-.2843.2413-.3556.5456-.3762.7024-.0562.0264-.1128.059-.1692.0983-.3394.2376-.4389.5756-.4706.7522-.2804.1159-.4486.3332-.5416.5123-.0508-.0419-.1184-.0931-.2036-.1377-.0931-.0485-.2492-.1131-.4492-.1236-.0152-.0145-.031-.0289-.0476-.0431-.0643-.0548-.4917-.4159-1.0768-.2089-.3922.1389-.5698.4369-.646.6238-.0328.0065-.064.0153-.0944.0243-.0207-.0226-.0438-.0459-.0691-.0692-.0767-.0707-.2647-.2272-.5576-.2773-.1964-.0335-.3833-.0086-.5481.0524-.1335-.0459-.294-.0741-.4735-.0561-.2468.0247-.4463.1274-.5892.2425-.223.1796-.3274.4037-.3744.5227-.1301-.0301-.2767-.0397-.4333-.0132-.2638.0448-.4571.1742-.58.2893-.1607.1508-.2525.3233-.3035.4432l-.0383.0993-.0027.0084-.0029.0065c-.0122.0344-.0242.0692-.0365.104-.0086.0028-.0175.0054-.026.0084-.0332-.0829-.0857-.1925-.1672-.2997-.0658-.0864-.2008-.2398-.4267-.341-.0808-.036-.1655-.0605-.2512-.0758l-.0365-.0946-.0056-.0131-.0355-.0769c-.0468-.0927-.13-.2278-.267-.3502-.1787-.1593-.4513-.2901-.765-.2781-.0724-.0783-.1706-.1626-.2996-.2305l-.0047-.0037-.0776-.0365c-.3838-.1665-.7614-.0722-1.0039.0796-.2031.1273-.3179.2911-.3641.3615-.0624.0953-.1115.1978-.1504.2904-.0722-.1147-.1811-.2438-.3436-.3466-.2069-.1307-.4554-.1898-.706-.1592-.2046.0251-.3609.1039-.4622.1695-.2401-.1767-.5352-.2427-.8172-.1938-.2476.0429-.4174.161-.4967.2238-.1371.1086-.2292.2334-.2765.3034-.0584-.0322-.1228-.0609-.1933-.0833-.163-.0519-.315-.0577-.4455-.0431.0062-.0223.0131-.0442.0188-.0656.0399-.1504.0964-.3798.0962-.5975,0-.0636-.0048-.1654-.0327-.2829-.0257-.1082-.0922-.3179-.2774-.5104-.2183-.2267-.5127-.3369-.8003-.3296-.0507.0013-.0988.0067-.1438.014-.0608-.0256-.1219-.0429-.1812-.0562-.0198-.018-.0415-.0362-.0634-.0534.0078-.1826-.0079-.4766-.1803-.7597-.128-.2095-.3267-.3872-.5846-.4832-.1798-.0669-.3489-.0793-.4865-.0712l-.127.0141h-.0046l-.0038.0009c-.1037.0167-.194.0467-.2661.0768l-.1569.0787c-.0412-.1369-.1163-.2932-.2503-.4336-.1548-.1622-.3384-.2528-.5043-.296-.1253-.0326-.2411-.0384-.3381-.0328-.0161-.0101-.0322-.0213-.0494-.0309-.2778-.1554-.5417-.1426-.6687-.1264-.0407-.1137-.1014-.2261-.1858-.3278.033-.1288.0557-.2999.0253-.4936-.0592-.3741-.2935-.6795-.6145-.84-.1927-.0965-.379-.122-.5126-.1265h-.1141l-.0064.0009h-.0057c-.0585.0026-.1188.0074-.1802.014.0464-.0764.0925-.1708.1242-.2809.0454-.1581.0794-.4136-.0298-.6959-.0385-.0992-.0884-.1848-.1439-.2584-.0012-.2009-.0585-.4144-.1896-.6042-.1283-.186-.2885-.2932-.4071-.3522-.0477-.0236-.0946-.0431-.1391-.058.0313-.0215.0627-.0427.0915-.0656.0485-.0388.1321-.1107.2119-.2154.0672-.0881.2316-.3283.2269-.679-.0057-.4278-.25-.7208-.4612-.8682-.1233-.086-.2439-.1315-.3307-.1564.0017-.033.0023-.0672.001-.1021-.006-.1487-.0398-.2793-.0887-.3915.0807-.0686.255-.2336.3408-.5105.1315-.4242-.0191-.8209-.2531-1.0639-.1747-.1816-.3683-.2548-.437-.2792-.1596-.0564-.3155-.0725-.3949-.0796-.1014-.0089-.2123-.0131-.3241-.014-.225-.0019-.5108.0082-.849.0262l-.0401.0009-.04.0028c-.0159.0009-.0322.0003-.0477.001-.0046-.0785-.0178-.1565-.0393-.2332.5048-.0667.9077-.1309,1.1907-.1949.1379-.031.3799-.0881.5827-.2031.0601-.0342.1639-.0995.2661-.2052.1-.1034.2652-.3161.3007-.6368.0089-.0801.0079-.1553.0019-.2258.0351-.0916.0609-.1933.0719-.3062.0614-.627-.3657-.9942-.5295-1.1127l-.0037-.0038-.0047-.0027-.127-.0806c-.1256-.0711-.2459-.1154-.3259-.1423-.1208-.0406-.2538-.0744-.3893-.1049.0166-.0016.0336-.0042.0513-.0057l.0391-.0038c.0964-.0083.1956-.0197.2896-.0365.0757-.0135.2241-.0429.3763-.1142.0733-.0345.2268-.1143.367-.2726.164-.1851.317-.4927.2615-.872-.0479-.3269-.2286-.5334-.3176-.6209-.0972-.0955-.1937-.1552-.2502-.1873-.0038-.0022-.0083-.0045-.0121-.0066-.018-.074-.0414-.1415-.0691-.2013.1309-.0093.3048-.0318.4678-.0955.0644-.0252.5708-.2196.6855-.8102.0305-.0393.0597-.0824.0868-.1283.3022-.5133.123-1.0116-.042-1.2663l-.0047-.0085-.0533-.0749c-.1272-.1665-.2752-.2737-.3464-.3231-.1077-.0748-.2281-.1437-.3464-.206-.0405-.0214-.0834-.0425-.128-.0646.0159.0024.0319.0064.0476.0084.0632.0082.2744.0361.5024-.0188.106-.0255.4373-.1196.6602-.4654.2651-.4116.1645-.8238.0814-1.0153-.0312-.0717-.0697-.1331-.1046-.1845.0545-.0106.1107-.0236.1662-.0421.1768-.0591.4292-.1883.6116-.4627.1007-.1514.1531-.308.1765-.4543.0742.0034.1588.0004.2484-.015.1364-.0234.3496-.0871.5454-.2632.2118-.1906.3169-.4353.3473-.6594.0489-.3595-.0957-.6332-.1269-.6931-.0554-.1062-.1207-.1953-.169-.2576-.0999-.1288-.2275-.2671-.3633-.4037l-.0317-.0309c-.0733-.0736-.1354-.1381-.1877-.1939,0-.0026.0018-.0058.0018-.0084.0025-.0922-.0061-.1811-.0196-.2641.0278-.0507.0513-.1024.0709-.1545.3223.2844.6057.5181.8293.6687.0915.0616.2753.1814.494.2426.094.0262.391.1013.7293-.0375.4256-.1748.6064-.5434.6557-.8251.0297-.0532.0536-.1059.0727-.1573.0235.0011.0481.0024.0728.0019.2669-.0055.567-.1147.7891-.3709l.0038-.0037c.1568-.0085.3307-.052.508-.1602.4675-.2853.5265-.7669.5379-.8832.0276-.28-.0381-.5796-.0924-.7914.0594.0512.1473.1175.2623.1714.1699.0796.5293.1877.9246-.0037.1221-.0592.2177-.135.2942-.2126.1295.042.2874.068.4687.045l.0038-.0009h.0028c.5837-.0745.8284-.5329.8974-.6968.0789-.1874.102-.3713.112-.4833.0185-.2054.0119-.4467-.0065-.6996ZM81.299,20.5338l.001-.0235v-.0093l-.001.0328Z";
  const RECORD_DISC = "M72.061,16.0465c0,3.5691-2.8849,6.4625-6.4436,6.4625s-6.4436-2.8934-6.4436-6.4625,2.885-6.4625,6.4436-6.4625,6.4436,2.8933,6.4436,6.4625Z";
  const RECORD_HOLE = "M65.6188,17.2937c.6868,0,1.2438-.5585,1.2438-1.2474s-.557-1.2474-1.2438-1.2474-1.2438.5584-1.2438,1.2474.5569,1.2474,1.2438,1.2474Z";
  const LETTERS = [
    "M44.8449,29.9911c-.7309,0-1.4802-.0731-2.2477-.2193-.7493-.1462-1.4528-.3746-2.1107-.6853-.6396-.2924-1.1878-.667-1.6447-1.1238l1.1513-3.0153c.5482.6031,1.2427,1.0599,2.0833,1.3706.8589.3106,1.7269.466,2.6041.466.9868,0,1.8091-.2102,2.467-.6305.6579-.402,1.1604-1.0234,1.5076-1.864.3472-.8406.5391-1.9005.5757-3.1797l.1918-2.5493h-.603c-.1828,1.2427-.4843,2.2478-.9046,3.0153s-.9503,1.3249-1.5899,1.6721c-.6213.3472-1.3523.5208-2.1929.5208-1.0416,0-1.9188-.2558-2.6315-.7675-.7127-.53-1.2518-1.3158-1.6172-2.3574-.3473-1.0599-.5209-2.3574-.5209-3.8924v-6.0854h3.6458v5.2082c0,1.7178.201,2.9604.603,3.728.402.7675,1.0234,1.1513,1.864,1.1513.4568,0,.868-.1188,1.2335-.3564.3655-.2376.6762-.5848.932-1.0416.2558-.4569.4568-1.0143.603-1.6721.1645-.6762.2559-1.4528.2742-2.33v-4.6874h3.6183v10.6083c0,1.1512-.1005,2.1929-.3016,3.1249-.1827.932-.4751,1.7452-.8771,2.4396-.3838.6944-.8681,1.2701-1.4528,1.7269-.5848.4751-1.261.8315-2.0285,1.0691-.7675.2375-1.6447.3563-2.6315.3563Z",
    "M33.0137,25.0297V5.5127h3.5635v19.517h-3.5635Z",
    "M23.2718,25.3859c-1.4254,0-2.6863-.2833-3.7828-.8498-1.0782-.5847-1.9279-1.4345-2.5492-2.5492-.6031-1.133-.9046-2.5219-.9046-4.1666,0-1.6812.3106-3.0792.932-4.1939.6396-1.1148,1.4985-1.9462,2.5766-2.4945,1.0965-.5482,2.3392-.8223,3.728-.8223,1.4071,0,2.6498.2832,3.728.8497,1.0964.5666,1.9553,1.4163,2.5766,2.5493.6396,1.1147.9594,2.5036.9594,4.1666,0,1.6995-.3198,3.1066-.9594,4.2213-.6396,1.1147-1.5076,1.9462-2.6041,2.4945-1.0964.5299-2.3299.7949-3.7005.7949ZM23.4089,22.6722c.7492,0,1.3797-.1737,1.8913-.5209.5117-.3654.9046-.8863,1.1787-1.5624.2742-.6944.4112-1.5351.4112-2.5219,0-1.0233-.1462-1.9005-.4386-2.6315-.2741-.7309-.6853-1.2883-1.2335-1.6721-.5482-.402-1.2335-.603-2.0558-.603-.731,0-1.3615.1736-1.8914.5208-.5117.3472-.9046.868-1.1787,1.5625-.2741.6761-.4112,1.5167-.4112,2.5218,0,1.5899.3289,2.8051.9868,3.6457.6579.8406,1.5716,1.261,2.7412,1.261Z",
    "M0,25.0297V5.5127h3.6457v4.4955c0,.3655-.0183.7492-.0548,1.1513-.0183.402-.0548.8132-.1097,1.2335-.0548.402-.1188.8132-.1919,1.2335-.0548.402-.1188.8132-.1919,1.2335h.5756c.2558-.9502.5848-1.7634.9868-2.4396.402-.6761.9137-1.197,1.535-1.5624.6396-.3655,1.4163-.5483,2.33-.5483,1.6812,0,2.933.5848,3.7553,1.7544.8224,1.1695,1.2336,2.9421,1.2336,5.3178v7.6478h-3.6458v-7.0996c0-1.5533-.2284-2.7046-.6853-3.4538-.4569-.7493-1.1513-1.1239-2.0833-1.1239-.7492,0-1.3797.2284-1.8914.6853-.4934.4386-.868,1.0325-1.1239,1.7817-.2558.7493-.4112,1.599-.466,2.5493v6.661H0Z",
    "M133.4686,5.3008c1.228,0,2.229.2575,3.001.7725.773.5149,1.317,1.2676,1.634,2.2578.317.9704.396,2.1289.237,3.4756l-3.445.4463c.059-.4555.089-.9213.089-1.3965s-.05-.9012-.149-1.2774c-.099-.396-.267-.7135-.505-.9511-.217-.2377-.505-.3564-.862-.3564-.277,0-.515.079-.713.2373-.198.1386-.356.3469-.474.624-.099.2575-.15.5749-.15.9512,0,.5743.12,1.0695.358,1.4854.257.4157.574.7723.95,1.0693.396.297.782.5841,1.158.8613.574.3763,1.11.7822,1.605,1.2178.515.4159.96.892,1.336,1.4268.396.5148.704,1.1185.921,1.8115.218.6734.328,1.4564.328,2.3476-.001,1.0099-.179,1.9206-.536,2.7325-.336.7921-.89,1.4165-1.663,1.872-.752.4357-1.763.6533-3.03.6533-1.089,0-2.001-.1777-2.733-.5341-.733-.3762-1.307-.8916-1.723-1.545-.038-.0646-.073-.1315-.108-.1982v1.9502h-8.319V5.627h3.832v16.3691h4.017c-.063-.2748-.109-.5619-.136-.8613-.059-.8911.041-1.8616.298-2.9111l3.505-.4454c-.139.8318-.198,1.634-.178,2.4063.02.7525.148,1.3665.386,1.8418.237.4555.654.6836,1.248.6836.297,0,.544-.0696.742-.208.198-.1585.347-.3865.446-.6836.119-.3168.178-.7029.178-1.1582,0-.8516-.148-1.5549-.445-2.1094-.297-.5545-.674-1.0297-1.129-1.4258-.456-.396-.931-.7629-1.426-1.0996-.436-.3367-.872-.6835-1.308-1.04-.435-.3565-.832-.7529-1.188-1.1885-.356-.4553-.644-.9699-.861-1.5439-.198-.5744-.297-1.2387-.297-1.9913,0-.9899.198-1.8513.594-2.5839.396-.7526.971-1.337,1.723-1.7529.772-.4158,1.703-.624,2.792-.624Z",
    "M115.2796,25.2343V5.627h3.862v19.6073h-3.862Z",
    "M105.7386,5.627l-3.268,19.6073h3.922l.413-3.6838h3.217l.44,3.6838h3.921l-3.268-19.6073h-5.377ZM109.7136,18.9659h-2.617l1.167-10.3978h.208l1.242,10.3978Z",
    "M91.6328,25.2343V5.627h4.6939c.6536,0,1.2675.0792,1.8419.2377.5942.1584,1.1289.3961,1.604.713.476.3169.882.7031,1.218,1.1586.357.4555.624.9903.802,1.6042.198.6139.297,1.2972.297,2.0498,0,.6536-.079,1.2676-.237,1.8419-.139.5744-.377,1.0893-.713,1.5448-.337.4556-.763.8418-1.278,1.1587-.5146.297-1.1385.505-1.8713.6238v.2377c.9705.0396,1.7133.2278,2.2283.5644.515.3367.891.8121,1.129,1.426.237.614.406,1.3567.505,2.2281l.594,4.2186h-3.9215l-.3862-3.6244c-.0594-.614-.1486-1.1784-.2674-1.6934-.099-.5347-.2971-.9506-.5941-1.2477-.2971-.2971-.7725-.4555-1.426-.4753h-.4456v7.0408h-3.773ZM95.4058,15.5495h.3564c.8517,0,1.4854-.2872,1.9014-.8616.4159-.5743.6238-1.4854.6238-2.7331,0-1.1487-.1782-1.9706-.5347-2.4658-.3565-.5149-.9111-.7724-1.6637-.7724h-.6832v6.8329Z",
    "M83.4279,25.5908c-1.2676,0-2.2876-.4159-3.06-1.2477-.7526-.8319-1.3071-2.0004-1.6636-3.5056-.3367-1.5052-.5051-3.2679-.5051-5.288,0-1.5448.109-2.9411.3268-4.1888.2179-1.2676.5645-2.3569,1.0398-3.2679.4951-.911,1.1487-1.6042,1.9607-2.0796.8121-.4951,1.8221-.7427,3.0303-.7427,1.0892,0,2.0003.1981,2.7331.5942.7328.3961,1.2972.9408,1.6933,1.6339.3962.6932.6437,1.4854.7427,2.3767.1189.8714.109,1.7924-.0297,2.7628l-3.5946.4456c.099-.9902.099-1.8419,0-2.5549-.0991-.7129-.2872-1.2576-.5645-1.6339-.2773-.3961-.6536-.5942-1.1289-.5942-.5347,0-.9704.2674-1.3071.8021-.3367.5347-.5942,1.2972-.7724,2.2875-.1585.9903-.2377,2.1885-.2377,3.5947,0,1.3665.0495,2.535.1485,3.5055.1189.9507.2773,1.733.4754,2.3469.2178.5942.4753,1.0299.7724,1.3072.297.2773.6337.4159,1.01.4159.4556,0,.8418-.1882,1.1587-.5645.3168-.3763.5644-.9011.7427-1.5745.1782-.6734.2871-1.4359.3267-2.2875h-1.931v-2.7926h5.3475v3.1194l.0297,6.7734h-2.6143l.1188-5.6742h-.2971c-.0198,1.1487-.1584,2.1786-.4159,3.0896-.2377.9111-.6437,1.634-1.218,2.1687-.5546.5149-1.327.7724-2.3172.7724Z",
  ];

  return (
    <svg
      viewBox="0 0 138.7876 32.0856"
      fill="none"
      className={className}
      onClick={handleClick}
      style={{ cursor: "pointer" }}
    >
      <g>
        {/* Vinyl record group — spins on click */}
        <g
          style={{
            transformOrigin: `${recordCx}px ${recordCy}px`,
            transition: spinning ? "transform 0.6s cubic-bezier(0.22, 1, 0.36, 1)" : "none",
            transform: spinning ? "rotate(720deg)" : "rotate(0deg)",
          }}
        >
          <path d={RECORD_BODY} fill={logomarkFill} />
          <path d={RECORD_DISC} fill="#EBFD00" />
          <path d={RECORD_HOLE} fill={logomarkFill} />
        </g>
        {/* Letter paths */}
        {LETTERS.map((d, i) => (
          <path key={i} d={d} fill={fill} />
        ))}
      </g>
    </svg>
  );
}

/** Compact Sun/Moon toggle switch */
function ThemeSwitch({
  isDark,
  onToggle,
  variant = "header",
}: {
  isDark: boolean;
  onToggle: () => void;
  variant?: "header" | "sidebar" | "topnav";
}) {
  const isHeader = variant === "header";
  const isTopnav = variant === "topnav";
  const trackBg = isTopnav
    ? (isDark ? "rgba(235,253,0,0.08)" : "rgba(12,40,74,0.1)")
    : isHeader
      ? (isDark ? "rgba(226,232,240,0.12)" : "rgba(12,40,74,0.12)")
      : "#01294D";
  const thumbBg = isTopnav
    ? (isDark ? "rgba(235,253,0,0.2)" : "#0C284A")
    : isHeader
      ? (isDark ? "rgba(226,232,240,0.25)" : "#0C284A")
      : "rgba(172,222,242,0.15)";
  const iconActiveColor = "#EBFD00";
  const iconInactiveColor = isTopnav
    ? (isDark ? "rgba(235,253,0,0.2)" : "rgba(12,40,74,0.25)")
    : isHeader
      ? (isDark ? "rgba(226,232,240,0.25)" : "rgba(12,40,74,0.35)")
      : "rgba(209,216,223,0.3)";

  return (
    <button
      onClick={onToggle}
      className="relative flex items-center rounded-full cursor-pointer transition-colors"
      style={{
        width: "52px",
        height: "28px",
        backgroundColor: trackBg,
        ...(variant === "sidebar" ? { border: "1px solid rgba(172,222,242,0.5)" } : {}),
        ...(isTopnav ? { border: `1px solid ${isDark ? "rgba(235,253,0,0.15)" : "rgba(12,40,74,0.15)"}` } : {}),
        ...(isHeader ? { border: `1px solid ${isDark ? "rgba(226,232,240,0.2)" : "transparent"}` } : {}),
      }}
      title={isDark ? "Switch to light mode" : "Switch to dark mode"}
    >
      <Sun
        size={12}
        strokeWidth={2}
        style={{
          position: "absolute",
          left: "8px",
          top: "50%",
          transform: "translateY(-50%)",
          color: isDark ? iconInactiveColor : iconActiveColor,
          transition: "color 200ms var(--ease-out)",
          zIndex: 1,
        }}
      />
      <Moon
        size={12}
        strokeWidth={2}
        style={{
          position: "absolute",
          right: "8px",
          top: "50%",
          transform: "translateY(-50%)",
          color: isDark ? iconActiveColor : iconInactiveColor,
          transition: "color 200ms var(--ease-out)",
          zIndex: 1,
        }}
      />
      <div
        style={{
          position: "absolute",
          top: "50%",
          transform: "translateY(-50%)",
          left: isDark ? "27px" : "3px",
          width: "22px",
          height: "22px",
          borderRadius: "50%",
          backgroundColor: thumbBg,
          transition: "left 200ms var(--ease-out)",
          boxShadow: "0 1px 3px rgba(0,0,0,0.15)",
        }}
      />
    </button>
  );
}

export function MobileHeader() {
  const { screen, setScreen, isDarkMode, toggleDarkMode, userAvatar } = useApp();

  const logoFill = isDarkMode ? "#E2E8F0" : "#0C284A";
  const activeBg = "rgba(172,222,242,0.12)";
  const inactiveBg = isDarkMode ? "rgba(255,255,255,0.1)" : "rgba(0,0,0,0.06)";

  return (
    <div
      className="flex items-center gap-[16px] lg:hidden px-[16px]"
      style={{
        height: "58px",
        background: "transparent",
      }}
    >
      {/* Left: Theme toggle */}
      <div className="flex-1 flex items-center">
        <ThemeSwitch isDark={isDarkMode} onToggle={toggleDarkMode} variant="header" />
      </div>

      {/* Center: Logo */}
      <button onClick={() => setScreen("feed")} className="shrink-0 cursor-pointer">
        <WordmarkLogo className="w-[156px] h-auto" fillColor={logoFill} isDarkMode={isDarkMode} />
      </button>

      {/* Right: Insights + Settings icons */}
      <div className="flex-1 flex items-center justify-end gap-1">
        <button
          onClick={() => setScreen("reports")}
          className="w-8 h-8 rounded-full flex items-center justify-center tappable transition-colors cursor-pointer"
          title="Insights"
          style={{
            color: screen === "reports" ? "#EBFD00" : "var(--c-text-muted)",
            backgroundColor: screen === "reports" ? activeBg : inactiveBg,
          }}
        >
          <BarChart3 size={18} strokeWidth={screen === "reports" ? 1.83 : 1.3125} />
        </button>
        <button
          onClick={() => setScreen("settings")}
          className="w-8 h-8 rounded-full flex items-center justify-center tappable transition-colors cursor-pointer"
          title="Settings"
          style={{
            color: screen === "settings" ? "#EBFD00" : "var(--c-text-muted)",
            padding: userAvatar ? 0 : undefined,
            overflow: userAvatar ? "hidden" : undefined,
            backgroundColor: screen === "settings" ? activeBg : inactiveBg,
          }}
        >
          {userAvatar ? (
            <img
              src={userAvatar}
              alt="Profile"
              className="w-8 h-8 rounded-full object-cover"
              style={{ border: screen === "settings" ? "2px solid #EBFD00" : "2px solid transparent" }}
            />
          ) : (
            <UserRound size={18} strokeWidth={screen === "settings" ? 1.83 : 1.3125} />
          )}
        </button>
      </div>
    </div>
  );
}

export function BottomTabBar() {
  const { screen, setScreen } = useApp();

  return (
    <nav
      className="fixed z-[130] flex items-center justify-between lg:hidden"
      style={{
        bottom: "calc(12px + env(safe-area-inset-bottom, 0px))",
        left: "10px",
        right: "10px",
        height: "60px",
        borderRadius: "9999px",
        paddingLeft: "4px",
        paddingRight: "4px",
        background: "linear-gradient(to bottom, rgb(33,69,100), rgb(1,41,77))",
        boxShadow: "0 4px 24px rgba(1,41,77,0.25), 0 1px 0 rgba(172,222,242,0.08) inset",
      }}
    >
      {MOBILE_NAV_ITEMS.map((item) => {
        const isActive = screen === item.id;
        const Icon = item.icon;
        return (
          <button
            key={item.id}
            onClick={() => setScreen(item.id)}
            className={`flex flex-1 flex-col items-center justify-center gap-[3px] px-[4px] h-[52px] rounded-full tappable transition-all ${
              isActive ? "bg-[rgba(172,222,242,0.12)]" : ""
            }`}
          >
            <Icon
              size={22}
              strokeWidth={isActive ? 1.83 : 1.26}
              color={isActive ? "#EBFD00" : "#D1D8DF"}
            />
            <span
              style={{
                fontSize: "11px",
                lineHeight: "11px",
                fontWeight: isActive ? 600 : 400,
                fontFamily: "'DM Sans', system-ui, sans-serif",
                color: isActive ? "#EBFD00" : "#D1D8DF",
              }}
            >
              {item.label}
            </span>
          </button>
        );
      })}
    </nav>
  );
}

/** Desktop top navigation bar — replaces sidebar on lg+ viewports */
export function DesktopTopNav() {
  const { screen, setScreen, isDarkMode, toggleDarkMode, userAvatar } = useApp();

  const logoFill = isDarkMode ? "#E2E8F0" : "#0C284A";
  const activeColor = isDarkMode ? "#E2E8F0" : "#0C284A";
  const inactiveColor = isDarkMode ? "rgba(226,232,240,0.45)" : "rgba(12,40,74,0.4)";
  const activeBg = isDarkMode ? "rgba(226,232,240,0.1)" : "rgba(12,40,74,0.08)";
  const avatarBorderColor = isDarkMode ? "#E2E8F0" : "#0C284A";

  const renderNavItem = (item: { id: Screen; label: string; icon: typeof Disc3 }) => {
    const isActive = screen === item.id;
    const Icon = item.icon;
    const isSettings = item.id === "settings";
    return (
      <button
        key={item.id}
        onClick={() => setScreen(item.id)}
        className="flex items-center gap-[7px] px-[12px] py-[7px] rounded-[8px] tappable transition-all cursor-pointer"
        style={{
          backgroundColor: isActive ? activeBg : "transparent",
        }}
      >
        {isSettings && userAvatar ? (
          <img
            src={userAvatar}
            alt="Profile"
            className="rounded-full object-cover"
            style={{
              width: "20px",
              height: "20px",
              border: isActive ? `1.5px solid ${avatarBorderColor}` : "1.5px solid transparent",
            }}
          />
        ) : (
          <Icon
            size={17}
            strokeWidth={isActive ? 1.8 : 1.2}
            color={isActive ? "#EBFD00" : inactiveColor}
          />
        )}
        <span
          style={{
            fontSize: "13px",
            fontWeight: isActive ? 600 : 400,
            lineHeight: "13px",
            fontFamily: "'Bricolage Grotesque', system-ui, sans-serif",
            color: isActive ? activeColor : inactiveColor,
            transition: "color 150ms ease",
          }}
        >
          {item.label}
        </span>
      </button>
    );
  };

  return (
    <header
      className="hidden lg:flex items-center flex-shrink-0 px-[24px]"
      style={{
        height: "58px",
        background: "transparent",
      }}
    >
      {/* Left nav group */}
      <nav className="flex-1 flex items-center gap-[2px]">
        {DESKTOP_LEFT_NAV.map(renderNavItem)}
      </nav>

      {/* Center: Logo */}
      <button onClick={() => setScreen("feed")} className="shrink-0 cursor-pointer mx-[16px]">
        <WordmarkLogo className="w-[156px] h-auto" fillColor={logoFill} isDarkMode={isDarkMode} />
      </button>

      {/* Right nav group + theme toggle */}
      <nav className="flex-1 flex items-center justify-end gap-[2px]">
        {DESKTOP_RIGHT_NAV.map(renderNavItem)}
        <div className="ml-[8px]">
          <ThemeSwitch isDark={isDarkMode} onToggle={toggleDarkMode} variant="header" />
        </div>
      </nav>
    </header>
  );
}